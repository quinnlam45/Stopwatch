{{define "content"}}
		<section>
			<div id="stopwatch" name="stopwatch">
				<div id="timer" name="timer"><p class="clock">00:00:00.00</p></div>
				<div id="buttons" name="buttons" class="d-flex flex-row justify-content-center align-content-center">
						<div class="d-flex flex-column justify-content-end">
							<input id="start-button" class="btn btn-primary" type="button" style="display: inline-block" onclick="start()" value="Start">
							<input id="continue-button" class="btn btn-primary" type="button" style="display: none" onclick="continueTimer()" value="Continue">
							<input id="pause-button" class="btn btn-primary" type="button" style="display: none" onclick="pause()" value="Pause">
						</div>
						<div class="d-flex flex-column">
							<input id="stop-button" class="btn btn-primary" type="button" style="display: none" onclick="stop()" value="Stop">
							<input id="reset-button" class="btn btn-primary" type="button" style="display: none" onclick="reset()" value="Reset">
						</div>
				</div> 
			</div>
			<div id="record-form" class="container-sm" style="display: none">
				<form method="post" action="/" class="row g-1">
						<input type="hidden" id="ticker-time" name="ticker-time" value="">
						
						<div id="distance-input" class="row align-items-end">
							<div class="col-sm">
								<label for="distance">Distance</label>
								<input type="number" min="0" step="0.1" id="distance" name="distance" class="form-control"/>
							</div>
							<div class="col-sm">
								<select id="distance-unit" name="distance-unit" class="form-select">
									<option value=1 selected>Miles</option>
									<option value=2>Km</option>
								</select>
							</div>
						</div>
						
						<div id="date-by-input" class="row align-items-end">
							<div class="col-sm-7">
								<label for="form-date">Date</label>
								<input type="date" id="form-date" name="form-date" class="form-control"/>
							</div>
							<div class="col-sm-5">
								<select id="completed-by" name="completed-by" class="form-select">
									<option value=1 selected>Bike</option>
									<option value=2>Running</option>
								</select>
							</div>
						</div>

						<div class="row align-items-end">
							<div class="col-3">
								<input class="btn btn-primary" type="submit" value="Submit"/>
							</div>
						</div>

				</form>
			</div>
		</section>
{{end}}

{{define "script"}}
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<script>
		function padTime(ms) {
			if (ms) {
				paddedTime = String(ms).padStart(2, '0');
				return paddedTime;
			} else {
				return "00";
			}		
		}
		
		function displayTime(ms) {
			hr = Math.floor(ms/3600000);
			min = Math.floor(ms/60000) % 60;
			sec = Math.floor(ms/1000) % 60;
			milliSec = Math.floor(ms/10) % 100;
			hrPad = padTime(hr)
			minPad = padTime(min)
			secPad = padTime(sec)
			milliSecPad = padTime(milliSec)

			return hrPad + ":" + minPad + ":" + secPad + "." + milliSecPad
		}

		var dispElapsed
		var msElapsed

		function startTimer(startTime) {
			msElapsed = Date.now() - startTime;
			dispElapsed = displayTime(msElapsed);
			document.querySelector('.clock').textContent = dispElapsed;
		}
		
		function hideAllButtons() {
			document.querySelector('#start-button').style.display = "none";
			document.querySelector('#pause-button').style.display = "none";
			document.querySelector('#continue-button').style.display = "none";
			document.querySelector('#stop-button').style.display = "none";			
			document.querySelector('#reset-button').style.display = "none";			
		}
		
		function start(msElapsed = 0) {
			startTime = Date.now() - msElapsed
			createClock = setInterval(startTimer, 10, startTime);
			document.querySelector('#start-button').style.display = "none";
			document.querySelector('#pause-button').style.display = "inline-block";
			document.querySelector('#stop-button').style.display = "inline-block";
		}

		function stop() {
			clearInterval(createClock);
			setFormDate();
			document.querySelector('#pause-button').style.display = "none";
			document.querySelector('#stop-button').style.display = "none";
			document.querySelector('#reset-button').style.display = "inline-block";
			document.querySelector('#record-form').style.display = "inline-block";
			let formTime = document.querySelector("input[id='ticker-time']");
			formTime.value = dispElapsed;
		}
		
		function reset() {
			msElapsed = 0
			document.querySelector('.clock').textContent = "00:00:00.00";
			document.querySelector('#pause-button').style.display = "none";
			document.querySelector('#reset-button').style.display = "none";
			document.querySelector('#continue-button').style.display = "none";
			document.querySelector('#stop-button').style.display = "none";
			document.querySelector('#record-form').style.display = "none";
			document.querySelector('#start-button').style.display = "inline-block";
		}

		function pause() {
			stop();
			document.querySelector('#pause-button').style.display = "none";
			document.querySelector('#stop-button').style.display = "none";
			document.querySelector('#record-form').style.display = "inline-block";
			document.querySelector('#continue-button').style.display = "inline-block";
		}

		function continueTimer() {
			start(msElapsed);
			document.querySelector('#continue-button').style.display = "none";
			document.querySelector('#record-form').style.display = "none";
			document.querySelector('#reset-button').style.display = "none";
			document.querySelector('#stop-button').style.display = "inline-block";
		}

		function setFormDate() {
			// set current date on form
			let currentDate = new Date().toISOString().slice(0,10);
			let formDate = document.querySelector("input[id='form-date']");
			formDate.value = currentDate;
		}
	  
    </script>
{{end}}