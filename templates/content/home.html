{{define "content"}}
		<section>
			<div id="stopwatch" name="stopwatch">
				<div id="timer" name="timer"><p class="clock">00:00:00.00</p></div>
				<div id="buttons" name="buttons" class="buttons">
					<input id="start-button" class="btn btn-primary" type="button" onclick="start()" value="Start">
					<input id="stop-button" class="btn btn-primary" type="button" onclick="stopTimer()" value="Stop">
					<input id="reset-button" class="btn btn-primary" type="button" style="display: none" onclick="reset()" value="Reset">
				</div> 
			</div>
			<div id="record-form" class="container" style="display: none">
				<form method="post" class="row g-1 align-items-end">
						<input type="hidden" id="ticker-time" name="ticker-time" value="">
						<div class="col">
							<label for="form-date">Date</label>
							<input type="date" id="form-date" name="form-date" class="form-control form-control-sm"/>
						</div>
						<div class="col-2">
							<label for="distance">Distance</label>
							<input type="text" id="distance" name="distance" class="form-control form-control-sm"/>
						</div>
						<div class="col">
							<select id="distance-unit" name="distance-unit" class="form-select form-select-sm">
								<option value="Mi" selected>Miles</option>
								<option value="Km">Km</option>
							</select>
						</div>
						<div class="col">
							<select id="completed-by" class="form-select form-select-sm">
								<option value="Bike" selected>Bike</option>
								<option value="Running">Running</option>
							</select>
						</div>
						<div class="col">
							<input class="btn btn-primary btn-sm" type="submit" value="Submit"/>
						</div>
				</form>
			</div>
		</section>
{{end}}

{{define "script"}}
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	<script>
		function padTime(ms) {
			if (ms) {
				paddedTime = String(ms).padStart(2, '0');
				return paddedTime;
			} else {
				return "00";
			}		
		}
		
		function displayTime(ms) {
			hr = Math.floor(ms/3600000);
			min = Math.floor(ms/60000) % 60;
			sec = Math.floor(ms/1000) % 60;
			milliSec = Math.floor(ms/10) % 100;
			hrPad = padTime(hr)
			minPad = padTime(min)
			secPad = padTime(sec)
			milliSecPad = padTime(milliSec)

			return hrPad + ":" + minPad + ":" + secPad + "." + milliSecPad
		}
		var dispElapsed

		function startTimer(startTime) {
			let elapsed = Date.now() - startTime;
			dispElapsed = displayTime(elapsed);
			document.querySelector('.clock').textContent = dispElapsed;
		}		
		
		function start() {
			let startTime = Date.now();
			createClock = setInterval(startTimer, 10, startTime);
			document.querySelector('#reset-button').style.display = "inline";
			document.querySelector('#start-button').className = "btn btn-primary disabled";
		}

		function stopTimer() {
			clearInterval(createClock);
			document.querySelector('#record-form').style.display = "inline";
			let formTime = document.querySelector("input[id='ticker-time']")
			formTime.value = dispElapsed
		}
		
		function reset() {
			document.querySelector('#start-button').className = "btn btn-primary";
			document.querySelector('.clock').textContent = "00:00:00.00";
			document.querySelector('#record-form').style.display = "none";
		}

		// set current date on form
		let currentDate = new Date().toISOString().slice(0,10);
		let formDate = document.querySelector("input[id='form-date']");
		formDate.value = currentDate;
	  
    </script>
{{end}}